@page "/"
@inject OrdersClient Client

<h1>Place your order</h1>

<EditForm Model="@order" OnValidSubmit="@SubmitAsync">
    <DataAnnotationsValidator />
    <ValidationSummary />

    @if (message != null)
    {
        <h4>Something went wrong...</h4>
        <p>@message</p>
    }
    <h2>
        The catalog items will be here.
    </h2>
    <p>
        Account Id: <InputText bind-Value="@(order.AccountId)" />
    </p>
    <button type="submit">Place Order!</button>
</EditForm>

@functions {
    Models.Order order = new Models.Order();
    string message;

    async Task SubmitAsync(EditContext context)
    {
        message = null;

        try
        {
            await Client.PlaceOrderAsync(order);
            order = new Models.Order();
        }
        catch (Exception ex)
        {
            message = ex.Message;
        }
    }
}