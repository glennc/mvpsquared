@page "/"
@inject OrdersClient Client

<h1>Place your order</h1>

<EditForm Model="@order" OnValidSubmit="@SubmitAsync">
    <DataAnnotationsValidator />
    <ValidationSummary />

    @if (message != null)
    {
        <h4>Something went wrong...</h4>
        <p>@message</p>
    }

    <p>
        Account Id: <InputText bind-Value="@(order.AccountId)" />
    </p>
    <p>
        Quantity: <InputNumber bind-Value="@order.NumberOfWidgets" />
    </p>
    <p>
        Price (per-Widget): <InputNumber bind-Value="@order.PricePerWidget" />
    </p>
    <button type="submit">Place Order!</button>
</EditForm>

@functions {
    Order order = new Order();
    string message;

    async Task SubmitAsync(EditContext context)
    {
        message = null;

        try
        {
            await Client.PlaceOrderAsync(order);
            order = new Order();
        }
        catch (Exception ex)
        {
            message = ex.Message;
        }
    }
}